<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å¼€å§‹ä½¿ç”¨ Canary | Canary</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/Canary/assets/css/0.styles.67e2065c.css" as="style"><link rel="preload" href="/Canary/assets/js/app.998a5de4.js" as="script"><link rel="preload" href="/Canary/assets/js/2.eeb24f79.js" as="script"><link rel="preload" href="/Canary/assets/js/22.13e22dab.js" as="script"><link rel="prefetch" href="/Canary/assets/js/10.7485543c.js"><link rel="prefetch" href="/Canary/assets/js/11.08594fb4.js"><link rel="prefetch" href="/Canary/assets/js/12.ffdb3b2e.js"><link rel="prefetch" href="/Canary/assets/js/13.1c761d0d.js"><link rel="prefetch" href="/Canary/assets/js/14.4c909cad.js"><link rel="prefetch" href="/Canary/assets/js/15.3011369a.js"><link rel="prefetch" href="/Canary/assets/js/16.cb0417ae.js"><link rel="prefetch" href="/Canary/assets/js/17.c9ce0f16.js"><link rel="prefetch" href="/Canary/assets/js/18.46fde132.js"><link rel="prefetch" href="/Canary/assets/js/19.7ff45738.js"><link rel="prefetch" href="/Canary/assets/js/20.9e9991f9.js"><link rel="prefetch" href="/Canary/assets/js/21.004281b7.js"><link rel="prefetch" href="/Canary/assets/js/23.3ea781f1.js"><link rel="prefetch" href="/Canary/assets/js/24.96a507c6.js"><link rel="prefetch" href="/Canary/assets/js/25.7b42744d.js"><link rel="prefetch" href="/Canary/assets/js/3.9f4e4011.js"><link rel="prefetch" href="/Canary/assets/js/4.f876ad59.js"><link rel="prefetch" href="/Canary/assets/js/5.18c5236f.js"><link rel="prefetch" href="/Canary/assets/js/6.e86df8f9.js"><link rel="prefetch" href="/Canary/assets/js/7.4df03673.js"><link rel="prefetch" href="/Canary/assets/js/8.0e01ec4b.js"><link rel="prefetch" href="/Canary/assets/js/9.18cf393c.js">
    <link rel="stylesheet" href="/Canary/assets/css/0.styles.67e2065c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Canary/" class="home-link router-link-active"><img src="/Canary/image/logo.svg" alt="Canary" class="logo"> <span class="site-name can-hide">Canary</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Canary/" class="nav-link">
  ä¸»é¡µ
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Canary/" class="nav-link">
  ä¸»é¡µ
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Canary/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group depth-0"><a href="/Canary/start/" class="sidebar-heading clickable router-link-active open"><span>æ•™ç¨‹</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Canary/start/what_is_adversarial_attack_and_model_robustness.html" class="sidebar-link">ä»€ä¹ˆæ˜¯å¯¹æŠ—æ”»å‡»ä¸æ¨¡å‹é²æ£’æ€§ï¼Ÿ</a></li><li><a href="/Canary/start/get-started-with-canary-sefi.html" aria-current="page" class="active sidebar-link">å¼€å§‹ä½¿ç”¨ Canary</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Canary/start/get-started-with-canary-sefi.html#ç¬¬0æ­¥-å‡†å¤‡" class="sidebar-link">ç¬¬0æ­¥ï¼šå‡†å¤‡</a></li><li class="sidebar-sub-header"><a href="/Canary/start/get-started-with-canary-sefi.html#ç¬¬1æ­¥-å§”æ‰˜æ¨¡å‹ã€æ”»å‡»æ–¹æ³•è‡³canary" class="sidebar-link">ç¬¬1æ­¥ï¼šå§”æ‰˜æ¨¡å‹ã€æ”»å‡»æ–¹æ³•è‡³Canary</a></li><li class="sidebar-sub-header"><a href="/Canary/start/get-started-with-canary-sefi.html#ç¬¬2æ­¥-é…ç½®canary" class="sidebar-link">ç¬¬2æ­¥ï¼šé…ç½®Canary</a></li><li class="sidebar-sub-header"><a href="/Canary/start/get-started-with-canary-sefi.html#ç¬¬3æ­¥-canaryå¯åŠ¨" class="sidebar-link">ç¬¬3æ­¥ï¼šCanaryå¯åŠ¨</a></li><li class="sidebar-sub-header"><a href="/Canary/start/get-started-with-canary-sefi.html#æœ€åæç¤º" class="sidebar-link">æœ€åæç¤º</a></li></ul></li><li><a href="/Canary/start/get-started-with-canary-sefi-use-library.html" class="sidebar-link">å¼€å§‹ä½¿ç”¨ Canary Library</a></li><li><a href="/Canary/start/integrate_your_own_model.html" class="sidebar-link">æ¨¡å‹é›†æˆæŒ‡å—</a></li><li><a href="/Canary/start/integrate_your_own_method.html" class="sidebar-link">æ”»å‡»æ–¹æ³•é›†æˆæŒ‡å—</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/Canary/guide/" class="sidebar-heading clickable"><span>æ“ä½œæŒ‡å—</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Canary/guide/how-does-canary-run.html" class="sidebar-link">Canary æ¡†æ¶çš„è®¾è®¡åŸç†</a></li><li><a href="/Canary/guide/how-to-install-canary.html" class="sidebar-link">å®‰è£… Canary</a></li><li><a href="/Canary/guide/how-to-use-canary-lib.html" class="sidebar-link">ä½¿ç”¨ Canary Library</a></li><li><a href="/Canary/guide/how-to-configure-clients.html" class="sidebar-link">é…ç½® Canary SEFI å®¢æˆ·ç«¯</a></li><li><a href="/Canary/guide/how-to-get-and-handle-synthetical-evaluation-results.html" class="sidebar-link">è·å–ä¸å¤„ç†ç»¼åˆè¯„ä¼°ç»“æœ</a></li><li><a href="/Canary/guide/how-to-recovery-task.html" class="sidebar-link">æ¢å¤ä»»åŠ¡</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/Canary/api/" class="sidebar-heading clickable"><span>Canary APIå‚è€ƒ</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Canary/api/api-reference-for-decorators.html" class="sidebar-link">è£…é¥°å™¨çš„ API å‚è€ƒ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/Canary/library/" class="sidebar-heading clickable"><span>Canary Library åº“å‚è€ƒ</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/Canary/method_library/method_list" class="sidebar-heading clickable open"><span>å·²é›†æˆçš„æ”»å‡»æ–¹æ³•</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Canary/library/method_list/mim.html" class="sidebar-link">MI-FGSM (MIM)</a></li><li><a href="/Canary/library/method_list/cw.html" class="sidebar-link">C&amp;W</a></li><li><a href="/Canary/library/method_list/qfool.html" class="sidebar-link">qFool</a></li></ul></section></li></ul></section></li><li><a href="/Canary/about.html" class="sidebar-link">å…³äºCanary</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="å¼€å§‹ä½¿ç”¨-canary"><a href="#å¼€å§‹ä½¿ç”¨-canary" class="header-anchor">#</a> å¼€å§‹ä½¿ç”¨ Canary</h1> <p>æ¬¢è¿æ¥åˆ°Canaryæ¨¡å‹å¯¹æŠ—é²æ£’æ€§è¯„ä¼°æ¡†æ¶å­¦ä¹ æ•™ç¨‹ï¼</p> <p>åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>Canary</code> å’Œ <code>PyTorch</code> æ„å»ºä¸€ä¸ªç®€å•çš„æ¨¡å‹é²æ£’æ€§æµ‹è¯•ä»»åŠ¡ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨<code>Canary Library</code>æä¾›äº†å¤§é‡æ”»å‡»æ–¹æ³•å’Œé¢„è®­ç»ƒæ¨¡å‹ï¼Œä½¿ç”¨<code>Canary Library</code>å¯ä»¥é¿å…é‡å¤é€ è½®å­ï¼Œå¹¶æå¤§çš„å‡å°‘æˆ‘ä»¬çš„å·¥ä½œé‡ã€‚<strong>ä½†æˆ‘ä»¬å¸Œæœ›åœ¨æœ¬ç« èŠ‚è¿›è¡Œä¸€ä¸ªç›¸å¯¹å®Œæ•´çš„æ¼”ç¤ºï¼Œä»¥å®Œæ•´å±•ç¤ºCanaryæ¡†æ¶çš„åŸºæœ¬åŠŸèƒ½ä¸è¿è¡Œé€»è¾‘ï¼Œå› æ­¤æˆ‘ä»¬å°†ä¸ä½¿ç”¨ä»»ä½•ç”± <code>Canary Library</code> æä¾›çš„æ”»å‡»æ–¹æ³•æˆ–æ¨¡å‹ã€‚</strong></p> <div class="custom-block tip"><p class="custom-block-title">æˆ‘ä»¬çš„å°å»ºè®®</p> <p>ä½†æˆ‘ä»¬ä»ç„¶æ€€ç–‘è¿™ç¯‡è¯¦ç»†çš„æ•™ç¨‹å¯èƒ½å¯¹æˆ‘ä»¬çš„æ–°æœ‹å‹ä»¬å¹¶ä¸å‹å¥½ï¼Œå¤§å®¶æˆ–è®¸æ›´å€¾å‘äºå°è¯•è¿è¡Œä»£ç è€Œä¸æ˜¯é¢å¯¹å†—æ‚çš„æ¨¡å‹ä¸æ”»å‡»æ–¹æ³•å‡†å¤‡ã€é›†æˆå’Œè°ƒè¯•ï¼Œ<strong>å› ä¸ºè¿™å¯èƒ½ä½¿æ‚¨çš„å¤´å‘æ•°é‡-10086</strong>ã€‚æ‰€ä»¥å¦‚æœæ‚¨ç¡®å®æ˜¯è¿™æ ·æƒ³çš„ï¼Œé‚£ä¹ˆè¯·ä¸è¦ç»§ç»­é˜…è¯»æœ¬æ•™ç¨‹çš„å…¶ä»–å†…å®¹ï¼Œè®©æˆ‘ä»¬è½¬åˆ° <a href="/Canary/start/get-started-with-canary-sefi-use-library.html">å¼€å§‹ä½¿ç”¨ Canary Library</a> ç»§ç»­é˜…è¯»ã€‚</p></div> <p>å¦‚æœæ‚¨æ‹’ç»æˆ‘ä»¬çš„å°å»ºè®®ï¼Œé‚£ä¹ˆï¼Œ<strong>å‹‡è€…</strong>ï¼è¯·è®©æˆ‘ä»¬ <s>åŸç¥å¯åŠ¨</s> å§ï¼</p> <h2 id="ç¬¬0æ­¥-å‡†å¤‡"><a href="#ç¬¬0æ­¥-å‡†å¤‡" class="header-anchor">#</a> ç¬¬0æ­¥ï¼šå‡†å¤‡</h2> <p>åœ¨å¼€å§‹ç¼–å†™ä»»ä½•å®é™…ä»£ç ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç¡®ä¿æˆ‘ä»¬å·²ç»åšå¥½äº†ä¸€åˆ‡å¿…è¦çš„å‡†å¤‡ã€‚</p> <h3 id="å®‰è£…ä¾èµ–é¡¹"><a href="#å®‰è£…ä¾èµ–é¡¹" class="header-anchor">#</a> å®‰è£…ä¾èµ–é¡¹</h3> <p>æˆ‘ä»¬å®‰è£… <code>PyTorch</code> (å’Œ<code>Torchvision</code>) å’Œ <code>Canary</code> æ‰€éœ€çš„è½¯ä»¶åŒ…ï¼š</p> <div class="language-sh extra-class"><pre class="language-sh"><code>pip <span class="token function">install</span> torch torchvision torchaudio
pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirement.txt
</code></pre></div><p>* ä¸ºç¡®ä¿<code>Canary Library</code>é¡¹ç›®å¯ç”¨ï¼Œæˆ‘ä»¬æ¨è<code>PyTorch</code>çš„ç‰ˆæœ¬åº”è‡³å°‘ â‰¥ 2.0.0</p> <h3 id="å‡†å¤‡æ•°æ®é›†ä¸æ¨¡å‹"><a href="#å‡†å¤‡æ•°æ®é›†ä¸æ¨¡å‹" class="header-anchor">#</a> å‡†å¤‡æ•°æ®é›†ä¸æ¨¡å‹</h3> <p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨æµè¡Œçš„<code>CIFAR-10</code>æ•°æ®é›†ä¸Šè®­ç»ƒçš„ç®€å•å·ç§¯ç¥ç»ç½‘ç»œ<code>CNN</code>æ¥ä»‹ç»å¯¹æŠ—é²æ£’æ€§è¯„ä¼°ã€‚</p> <p>æˆ‘ä»¬å‡è®¾æ‚¨å·²ç»è¶³å¤Ÿç†Ÿç»ƒçš„ä½¿ç”¨<code>PyTorch</code>ï¼Œå› æ­¤ä¸ä¼šè¯¦ç»†ä»‹ç»ä¸<code>PyTorch</code>ç›¸å…³çš„æ–¹é¢ã€‚å¦‚æœæ‚¨æƒ³æ›´æ·±å…¥åœ°äº†è§£<code>PyTorch</code>ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨å‚è€ƒ <a href="https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ PYTORCH è¿›è¡Œæ·±åº¦å­¦ä¹ ï¼š60 åˆ†é’Ÿé—ªç”µæˆ˜<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Torchvision</code>ä¸­è‡ªå¸¦çš„æ•°æ®é›†<code>CIFAR-10</code>ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code>trainset <span class="token operator">=</span> CIFAR10<span class="token punctuation">(</span><span class="token string">&quot;workspace/dataset/CIFAR10&quot;</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>transform<span class="token punctuation">)</span>
</code></pre></div><p>æˆ‘ä»¬ä½¿ç”¨è¿™ä¸€æ•°æ®é›†è®­ç»ƒ<code>PyTorch</code>æ•™ç¨‹ä¸­æè¿°çš„ç®€å•<code>CNN</code>ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Net</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Net<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>pool <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x
</code></pre></div><p>æˆ‘ä»¬å‡è®¾æ‚¨å·²ç»å®Œæˆäº†è®­ç»ƒå·¥ä½œï¼Œæ­¤æ—¶æˆ‘ä»¬ä¿å­˜æ¨¡å‹æƒé‡ï¼Œå³å¾—åˆ°äº†ä¸€ä¸ªæ¨¡å‹çš„é¢„è®­ç»ƒæƒé‡æ–‡ä»¶<code>net.pth</code>ã€‚æ‚¨åº”å½“ç¡®ä¿ä»¥ä¸‹è¿‡ç¨‹æ˜¯å¯ä»¥æ­£ç¡®æ‰§è¡Œçš„ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># é¢„å¤„ç†å›¾ç‰‡</span>
img <span class="token operator">/=</span> <span class="token number">255.0</span>
img <span class="token operator">=</span> ori_img<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
img <span class="token operator">=</span> torch<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
img <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>img<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># åŠ è½½æ¨¡å‹</span>
net <span class="token operator">=</span> Net<span class="token punctuation">(</span><span class="token punctuation">)</span>
net<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'workspace/model/net.pth'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># æ¨ç†</span>
outputs <span class="token operator">=</span> net<span class="token punctuation">(</span>images<span class="token punctuation">)</span>

<span class="token comment"># ç»“æœå¤„ç†</span>
results <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
results <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># æ‰“å°ç»“æœ</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
</code></pre></div><h3 id="å‡†å¤‡å¯¹æŠ—æ”»å‡»-adversarial-attack-æ–¹æ³•"><a href="#å‡†å¤‡å¯¹æŠ—æ”»å‡»-adversarial-attack-æ–¹æ³•" class="header-anchor">#</a> å‡†å¤‡å¯¹æŠ—æ”»å‡»(Adversarial Attack)æ–¹æ³•</h3> <p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¤ç°<code>Goodfellow</code>ç­‰äººå‘è¡¨åœ¨<code>ICLR2015</code>ä¼šè®®ä¸Šçš„<code>Fast Gradient Sign Method/FGSM</code>ç®—æ³•æ¥ä»‹ç»å¯¹æŠ—é²æ£’æ€§è¯„ä¼°ã€‚</p> <p>åœ¨ç™½ç›’ç¯å¢ƒä¸‹ï¼Œ<code>FGSM</code>é€šè¿‡æ±‚å‡ºæ¨¡å‹å¯¹è¾“å…¥çš„å¯¼æ•°ï¼Œç„¶åç”¨ç¬¦å·å‡½æ•°å¾—åˆ°å…¶å…·ä½“çš„æ¢¯åº¦æ–¹å‘ï¼Œæ²¿ç€æ¢¯åº¦æ–¹å‘è¡Œè¿›ä¸€ä¸ªæ­¥é•¿ï¼Œå³å¯å¾—åˆ°â€œå¯¹æŠ—æ‰°åŠ¨â€ï¼Œå°†å…¶å åŠ åœ¨åŸè¾“å…¥ä¸Šå³å¾—åˆ°äº†å¯¹æŠ—æ ·æœ¬ã€‚</p> <p>æˆ‘ä»¬å¤ç°<code>FGSM</code>çš„ä¸€ä¸ªè¿­ä»£ç‰ˆæœ¬ï¼ˆ<code>I-FGSM</code>ï¼‰å¦‚ä¸‹ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">I_FGSM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> model<span class="token punctuation">,</span> clip_min<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> clip_max<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> T<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>model <span class="token operator">=</span> model  <span class="token comment"># å¾…æ”»å‡»çš„ç™½ç›’æ¨¡å‹</span>
        self<span class="token punctuation">.</span>T <span class="token operator">=</span> T  <span class="token comment"># è¿­ä»£æ”»å‡»è½®æ•°</span>
        self<span class="token punctuation">.</span>epsilon <span class="token operator">=</span> epsilon  <span class="token comment"># ä»¥æ— ç©·èŒƒæ•°ä½œä¸ºçº¦æŸï¼Œè®¾ç½®æœ€å¤§å€¼</span>
        self<span class="token punctuation">.</span>clip_min <span class="token operator">=</span> clip_min  <span class="token comment"># åƒç´ å€¼çš„ä¸‹é™</span>
        self<span class="token punctuation">.</span>clip_max <span class="token operator">=</span> clip_max  <span class="token comment"># åƒç´ å€¼çš„ä¸Šé™</span>

    <span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># æŸå¤±å‡½æ•°</span>
        loss_ <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># å…‹éš†åŸå§‹æ•°æ®</span>
        ori_img <span class="token operator">=</span> img<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># å®šä¹‰å›¾ç‰‡å¯è·å–æ¢¯åº¦</span>
        img<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">True</span>

        <span class="token comment"># è¿­ä»£æ”»å‡»</span>
        <span class="token keyword">for</span> <span class="token builtin">iter</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># æ¨¡å‹é¢„æµ‹</span>
            self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
            output <span class="token operator">=</span> self<span class="token punctuation">.</span>model<span class="token punctuation">(</span>img<span class="token punctuation">)</span>

            <span class="token comment"># è®¡ç®—lossï¼Œéé¶å‘æ”»å‡»</span>
            loss <span class="token operator">=</span> loss_<span class="token punctuation">(</span>output<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span>ori_labels<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>self<span class="token punctuation">.</span>device<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token comment"># åå‘ä¼ æ’­</span>
            loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
            grad <span class="token operator">=</span> img<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>data
            img<span class="token punctuation">.</span>grad <span class="token operator">=</span> <span class="token boolean">None</span>

            <span class="token comment"># æ›´æ–°å›¾åƒåƒç´ </span>
            img<span class="token punctuation">.</span>data <span class="token operator">=</span> img<span class="token punctuation">.</span>data <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>epsilon <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> self<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token operator">*</span> torch<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>grad<span class="token punctuation">)</span>
            img<span class="token punctuation">.</span>data <span class="token operator">=</span> self<span class="token punctuation">.</span>clip_value<span class="token punctuation">(</span>img<span class="token punctuation">,</span> ori_img<span class="token punctuation">)</span>

        <span class="token keyword">return</span> img

    <span class="token comment"># å°†å›¾ç‰‡è¿›è¡Œclip</span>
    <span class="token keyword">def</span> <span class="token function">clip_value</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> ori_x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-</span> ori_x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span>self<span class="token punctuation">.</span>epsilon<span class="token punctuation">,</span> self<span class="token punctuation">.</span>epsilon<span class="token punctuation">)</span> <span class="token operator">+</span> ori_x
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>clip_min<span class="token punctuation">,</span> self<span class="token punctuation">.</span>clip_max<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x<span class="token punctuation">.</span>data
</code></pre></div><h2 id="ç¬¬1æ­¥-å§”æ‰˜æ¨¡å‹ã€æ”»å‡»æ–¹æ³•è‡³canary"><a href="#ç¬¬1æ­¥-å§”æ‰˜æ¨¡å‹ã€æ”»å‡»æ–¹æ³•è‡³canary" class="header-anchor">#</a> ç¬¬1æ­¥ï¼šå§”æ‰˜æ¨¡å‹ã€æ”»å‡»æ–¹æ³•è‡³Canary</h2> <p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å·²å‡†å¤‡å®Œæˆçš„æ¨¡å‹å’Œæ”»å‡»æ–¹æ³•é›†æˆè‡³<code>Canary</code>ã€‚<code>Canary</code>ä½¿ç”¨ä¸€ç»„è£…é¥°å™¨ï¼Œä»¥æ”¶é›†å„ä¸ªç»„ä»¶ï¼ˆå¦‚æ¨¡å‹ã€æ”»å‡»é˜²å¾¡ç®—æ³•å’Œæ•°æ®é›†åŠ è½½å™¨ï¼‰ï¼Œå…¶ä¸­ï¼Œä¸æ¨¡å‹æœ‰å…³çš„è£…é¥°å™¨å¦‚ä¸‹ï¼š</p> <ul><li><strong>model</strong> - è£…é¥°ä¸€ä¸ªæ¨¡å‹ç”Ÿæˆå‡½æ•°
<ul><li><strong>name</strong> - æ¨¡å‹åç§°ã€‚</li></ul></li> <li><strong>util</strong> - è£…é¥°ä¸€ä¸ªå·¥å…·ç»„ä»¶å‡½æ•°ï¼Œå…¶ä¸­<code>util</code>è£…é¥°å™¨æ¥æ”¶ä»¥ä¸‹å‚æ•°ä»¥æ ‡è®°å‡½æ•°çš„å…·ä½“ä½œç”¨ï¼š
<ul><li><strong>util_type</strong> - å·¥å…·ç±»å‹ï¼šä¸€ä¸ª<code>SubComponentType</code>æšä¸¾å€¼ã€‚å…¶ä¸­ä¸æ¨¡å‹ç›¸å…³çš„ç±»å‹æœ‰ï¼š
<ul><li>å›¾ç‰‡é¢„å¤„ç†å™¨ <code>IMG_PREPROCESSOR</code>ã€</li> <li>å›¾ç‰‡é€†å¤„ç†å™¨ <code>IMG_REVERSE_PROCESSOR</code>ã€</li> <li>ç»“æœå¤„ç†å™¨ <code>RESULT_POSTPROCESSOR</code>ã€</li> <li>æ¨¡å‹æ¨ç†å™¨ <code>MODEL_INFERENCE_DETECTOR</code>ï¼›</li></ul></li> <li><strong>util_target</strong> - å·¥å…·ç›®æ ‡ï¼šä¸€ä¸ª<code>ComponentType</code>æšä¸¾å€¼ã€‚æ­¤å¤„æˆ‘ä»¬å°†å…¶è®¾ç½®ä¸º<code>MODEL</code>ï¼Œæ„å‘³ç€è¯¥å·¥å…·ç»„ä»¶å‡½æ•°æ˜¯ä¸ºæ¨¡å‹æœåŠ¡çš„ï¼›</li> <li><strong>name</strong> - è¯¥å·¥å…·ç»„ä»¶ç»‘å®šçš„ç›®æ ‡æ¨¡å‹åç§°ã€‚</li></ul></li></ul> <p>ä¸æ”»å‡»æ–¹æ³•æœ‰å…³çš„è£…é¥°å™¨å¦‚ä¸‹ï¼š</p> <ul><li><strong>attacker_class</strong> - è£…é¥°ä¸€ä¸ªæ”»å‡»æ–¹æ³•ç±»
<ul><li><strong>name</strong> - æ”»å‡»æ–¹æ³•åç§°ã€‚</li></ul></li> <li><strong>attack</strong> - è£…é¥°ä¸€ä¸ªæ”»å‡»æ–¹æ³•å‡½æ•°
<ul><li><strong>name</strong> - æ”»å‡»æ–¹æ³•åç§°ï¼›</li> <li><strong>is_inclass</strong> - è¯¥æ”»å‡»æ–¹æ³•å‡½æ•°æ˜¯å¦å±äºä¸€ä¸ªæ”»å‡»æ–¹æ³•ç±»ã€‚å¦‚æœè£…é¥°çš„å‡½æ•°åœ¨ä¸€ä¸ªæ”»å‡»æ–¹æ³•ç±»ä¸­ï¼Œåˆ™è¯¥é¡¹å¿…é¡»ä¸º<code>True</code>ï¼Œå¦åˆ™ä¸º<code>False</code>ï¼›</li> <li>å…¶ä»–å‚æ•°æš‚æ—¶ä¸åšé¢å¤–ä»‹ç»ã€‚</li></ul></li></ul> <h3 id="æ–°å»ºå·¥ç¨‹å¹¶æ„å»ºç›®å½•"><a href="#æ–°å»ºå·¥ç¨‹å¹¶æ„å»ºç›®å½•" class="header-anchor">#</a> æ–°å»ºå·¥ç¨‹å¹¶æ„å»ºç›®å½•</h3> <p>é¦–å…ˆï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªç›®å½•ç»“æ„ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>.
â”œâ”€â”€ model.py
â”œâ”€â”€ attack.py
â”œâ”€â”€ run.py
â”œâ”€â”€ config.json
â””â”€â”€ Canary_SEFI
</code></pre></div><p>æˆ‘ä»¬åœ¨<code>model.py</code>å’Œ<code>attack.py</code>ä¸­éƒ½åˆå§‹åŒ–ä¸€ä¸ª<code>SEFIComponent()</code>ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> canary_sefi<span class="token punctuation">.</span>core<span class="token punctuation">.</span>component<span class="token punctuation">.</span>component_decorator <span class="token keyword">import</span> SEFIComponent
sefi_component <span class="token operator">=</span> SEFIComponent<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="é›†æˆæ¨¡å‹ç”Ÿæˆå‡½æ•°è‡³canary"><a href="#é›†æˆæ¨¡å‹ç”Ÿæˆå‡½æ•°è‡³canary" class="header-anchor">#</a> é›†æˆæ¨¡å‹ç”Ÿæˆå‡½æ•°è‡³Canary</h3> <p><strong>ğŸ‘‡è¯·å°†è¯¥éƒ¨åˆ†å­˜æ”¾åœ¨<code>model.py</code>ä¸­ğŸ‘‡</strong></p> <p>æˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ªæ¨¡å‹ç”Ÿæˆå‡½æ•°ï¼Œä»¥æ­£ç¡®åŠ è½½æ¨¡å‹ï¼›ç„¶åæˆ‘ä»¬ä½¿ç”¨<code>@sefi_component.model</code>è¿›è¡Œè£…é¥°ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@sefi_component<span class="token punctuation">.</span>model</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;Net&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">create_model</span><span class="token punctuation">(</span>run_device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># æ¨¡å‹è¿è¡Œä½ç½®</span>
    run_device <span class="token operator">=</span> run_device <span class="token keyword">if</span> run_device <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token string">'cuda'</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'cpu'</span><span class="token punctuation">)</span>

    <span class="token comment"># åŠ è½½æ¨¡å‹</span>
    net <span class="token operator">=</span> Net<span class="token punctuation">(</span><span class="token punctuation">)</span>
    net<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'workspace/model/net.pth'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>run_device<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> net
</code></pre></div><h3 id="é›†æˆæ¨¡å‹å›¾ç‰‡å¤„ç†æ–¹æ³•å‡½æ•°è‡³canary"><a href="#é›†æˆæ¨¡å‹å›¾ç‰‡å¤„ç†æ–¹æ³•å‡½æ•°è‡³canary" class="header-anchor">#</a> é›†æˆæ¨¡å‹å›¾ç‰‡å¤„ç†æ–¹æ³•å‡½æ•°è‡³Canary</h3> <p><strong>ğŸ‘‡è¯·å°†è¯¥éƒ¨åˆ†å­˜æ”¾åœ¨<code>model.py</code>ä¸­ğŸ‘‡</strong></p> <p>ä»ç¬¬0æ­¥æˆ‘ä»¬å‡†å¤‡çš„æ¨¡å‹æµ‹è¯•ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸€å¼ å›¾ç‰‡è‹¥æƒ³è¢«æ¨¡å‹æ­£ç¡®å¤„ç†ï¼Œéœ€è¦è¿›è¡Œ<code>å›¾ç‰‡é¢„å¤„ç†</code>ğŸ‘‰<code>åŠ è½½æ¨¡å‹</code>ğŸ‘‰<code>æ¨ç†</code>ğŸ‘‰<code>ç»“æœå¤„ç†</code>å››ä¸ªé˜¶æ®µï¼Œå°½ç®¡æœ‰äº›é˜¶æ®µæ˜¯å¯é€‰çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºä»¥ä¸‹å‡½æ•°ï¼Œå¹¶ä½¿ç”¨@sefi_component.utilè¿›è¡Œè£…é¥°ï¼š</p> <p>å›¾ç‰‡é¢„å¤„ç†å‡½æ•°ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@sefi_component<span class="token punctuation">.</span>util</span><span class="token punctuation">(</span>util_type<span class="token operator">=</span>SubComponentType<span class="token punctuation">.</span>IMG_PREPROCESSOR<span class="token punctuation">,</span> util_target<span class="token operator">=</span>ComponentType<span class="token punctuation">.</span>MODEL<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Net&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">img_pre_handler</span><span class="token punctuation">(</span>ori_imgs<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    run_device <span class="token operator">=</span> args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;run_device&quot;</span><span class="token punctuation">,</span> <span class="token string">'cuda'</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'cpu'</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">for</span> ori_img <span class="token keyword">in</span> ori_imgs<span class="token punctuation">:</span>
        ori_img <span class="token operator">=</span> ori_img<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

        <span class="token comment"># é¢„å¤„ç†ä»£ç </span>
        ori_img <span class="token operator">/=</span> <span class="token number">255.0</span>
        ori_img <span class="token operator">=</span> ori_img<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        ori_img <span class="token operator">=</span> Variable<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>ori_img<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>run_device<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        ori_img <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>ori_img<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

        result <span class="token operator">=</span> ori_img <span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">else</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> ori_img<span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
</code></pre></div><p>è¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°<code>ori_imgs</code>å’Œ<code>args</code>ï¼š</p> <ul><li>å…¶ä¸­<code>ori_imgs</code>æ˜¯ä¸€ä¸ªç”±æ•°æ®é›†ä¸­è¯»å–çš„<code>numpy.ndarray</code>ç±»å‹çš„å›¾ç‰‡ï¼Œå…¶å½¢çŠ¶ä¸ºå½©è‰²å›¾ç‰‡çš„<code>[WÃ—HÃ—3]</code>æˆ–ç°åº¦å›¾ç‰‡çš„<code>[WÃ—HÃ—1]</code>ï¼›</li> <li><code>args</code>æ˜¯å›¾ç‰‡ä¸ç»“æœå¤„ç†å™¨çš„å…±ç”¨é…ç½®å‚æ•°ï¼Œç”±ç”¨æˆ·è‡ªè¡Œä¼ å…¥ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºç©ºã€‚</li></ul> <p>æ¨ç†å‡½æ•°ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@sefi_component<span class="token punctuation">.</span>util</span><span class="token punctuation">(</span>util_type<span class="token operator">=</span>SubComponentType<span class="token punctuation">.</span>MODEL_INFERENCE_DETECTOR<span class="token punctuation">,</span> util_target<span class="token operator">=</span>ComponentType<span class="token punctuation">.</span>MODEL<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Net&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">inference_detector</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> model<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
</code></pre></div><p>è¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°<code>model</code>å’Œ<code>img</code>ï¼š</p> <ul><li><code>model</code>æ˜¯æ¨¡å‹ç”Ÿæˆå‡½æ•°<code>create_model()</code>å‡½æ•°çš„è¾“å‡ºç»“æœï¼›</li> <li><code>img</code>æ˜¯æ¨¡å‹é¢„å¤„ç†å‡½æ•°<code>img_pre_handler()</code>å‡½æ•°çš„è¾“å‡ºç»“æœã€‚</li></ul> <p>æ¨¡å‹ç»“æœå¤„ç†å‡½æ•°ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@sefi_component<span class="token punctuation">.</span>util</span><span class="token punctuation">(</span>util_type<span class="token operator">=</span>SubComponentType<span class="token punctuation">.</span>RESULT_POSTPROCESSOR<span class="token punctuation">,</span> util_target<span class="token operator">=</span>ComponentType<span class="token punctuation">.</span>MODEL<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Net&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">result_post_handler</span><span class="token punctuation">(</span>logits<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    results <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>logits<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    predicts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        predicts<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> predicts<span class="token punctuation">,</span> results
</code></pre></div><p>è¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°<code>logits</code>å’Œ<code>args</code>ï¼š</p> <ul><li><code>logits</code>æ˜¯æ¨ç†å‡½æ•°<code>inference_detector()</code>å‡½æ•°çš„è¾“å‡ºç»“æœï¼›</li> <li><code>args</code>æ˜¯å›¾ç‰‡ä¸ç»“æœå¤„ç†å™¨çš„å…±ç”¨é…ç½®å‚æ•°ï¼Œç”±ç”¨æˆ·è‡ªè¡Œä¼ å…¥ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºç©ºã€‚</li></ul> <p>åœ¨äº§ç”Ÿå¯¹æŠ—æ ·æœ¬åï¼Œæˆ‘ä»¬éœ€è¦å°†å¯¹æŠ—æ ·æœ¬ä¿å­˜ä¸ºå›¾ç‰‡ã€‚ç”±äºç”Ÿæˆå¯¹æŠ—æ ·æœ¬æ—¶çš„å›¾ç‰‡å·²ç»è¿›è¡Œäº†é¢„å¤„ç†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç”¨æˆ·å®šä¹‰ä¸€ä¸ªé€†è½¬é¢„å¤„ç†çš„è¿‡ç¨‹ï¼Œä»¥è¿˜åŸä¸ºåŸå§‹å›¾åƒã€‚éœ€è¦æ„å»ºä»¥ä¸‹å›¾ç‰‡é€†å¤„ç†å‡½æ•°ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@sefi_component<span class="token punctuation">.</span>util</span><span class="token punctuation">(</span>util_type<span class="token operator">=</span>SubComponentType<span class="token punctuation">.</span>IMG_REVERSE_PROCESSOR<span class="token punctuation">,</span> util_target<span class="token operator">=</span>ComponentType<span class="token punctuation">.</span>MODEL<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Net&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">img_post_handler</span><span class="token punctuation">(</span>adv_imgs<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>adv_imgs<span class="token punctuation">)</span> <span class="token operator">==</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">:</span>
        adv_imgs <span class="token operator">=</span> adv_imgs<span class="token punctuation">.</span>data<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>

    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> adv_img <span class="token keyword">in</span> adv_imgs<span class="token punctuation">:</span>

        <span class="token comment"># é€†å¤„ç†ä»£ç </span>
        adv_img <span class="token operator">=</span> adv_img<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        adv_img <span class="token operator">=</span> adv_img <span class="token operator">*</span> <span class="token number">255.0</span>
        adv_img <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>adv_img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>adv_img<span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
</code></pre></div><p>è¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°<code>adv_imgs</code>å’Œ<code>args</code>ï¼š</p> <ul><li><code>adv_imgs</code>æ˜¯æ”»å‡»æ–¹æ³•å‡½æ•°<code>attack()</code>å‡½æ•°ï¼ˆè§ä¸‹ï¼‰çš„è¾“å‡ºç»“æœï¼›</li> <li><code>args</code>æ˜¯å›¾ç‰‡ä¸ç»“æœå¤„ç†å™¨çš„å…±ç”¨é…ç½®å‚æ•°ï¼Œç”±ç”¨æˆ·è‡ªè¡Œä¼ å…¥ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºç©ºã€‚</li></ul> <h3 id="é›†æˆæ”»å‡»æ–¹æ³•å‡½æ•°è‡³canary"><a href="#é›†æˆæ”»å‡»æ–¹æ³•å‡½æ•°è‡³canary" class="header-anchor">#</a> é›†æˆæ”»å‡»æ–¹æ³•å‡½æ•°è‡³Canary</h3> <p><strong>ğŸ‘‡è¯·å°†è¯¥éƒ¨åˆ†å­˜æ”¾åœ¨<code>attack.py</code>ä¸­ğŸ‘‡</strong></p> <p>æˆ‘ä»¬éœ€è¦å°†æ”»å‡»æ–¹æ³•å§”æ‰˜è‡³æ¨¡å‹ã€‚æˆ‘ä»¬ä½¿ç”¨<code>@sefi_component.attacker_class</code>è£…é¥°è¿™ä¸ªæ–¹æ³•ç±»ï¼Œå¹¶ä½¿ç”¨<code>@sefi_component.attack</code>è£…é¥°è¿™ä¸ªæ”»å‡»æ–¹æ³•å‡½æ•°ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@sefi_component<span class="token punctuation">.</span>attacker_class</span><span class="token punctuation">(</span>attack_name<span class="token operator">=</span><span class="token string">&quot;MI_FGSM&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">I_FGSM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> model<span class="token punctuation">,</span> run_device<span class="token punctuation">,</span> attack_type<span class="token operator">=</span><span class="token string">'UNTARGETED'</span><span class="token punctuation">,</span> clip_min<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> clip_max<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> T<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token number">4</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>model <span class="token operator">=</span> model  <span class="token comment"># å¾…æ”»å‡»çš„ç™½ç›’æ¨¡å‹</span>
        self<span class="token punctuation">.</span>device <span class="token operator">=</span> run_device
        self<span class="token punctuation">.</span>T <span class="token operator">=</span> T  <span class="token comment"># è¿­ä»£æ”»å‡»è½®æ•°</span>
        self<span class="token punctuation">.</span>epsilon <span class="token operator">=</span> epsilon  <span class="token comment"># ä»¥æ— ç©·èŒƒæ•°ä½œä¸ºçº¦æŸï¼Œè®¾ç½®æœ€å¤§å€¼</span>
        self<span class="token punctuation">.</span>clip_min <span class="token operator">=</span> clip_min  <span class="token comment"># åƒç´ å€¼çš„ä¸‹é™</span>
        self<span class="token punctuation">.</span>clip_max <span class="token operator">=</span> clip_max  <span class="token comment"># åƒç´ å€¼çš„ä¸Šé™</span>
        <span class="token operator">//</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token decorator annotation punctuation">@sefi_component<span class="token punctuation">.</span>attack</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;I_FGSM&quot;</span><span class="token punctuation">,</span> is_inclass<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img<span class="token punctuation">,</span> ori_labels<span class="token punctuation">,</span> tlabels<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token operator">//</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">return</span> img
</code></pre></div><p><strong>è¯·æ³¨æ„ï¼Œä¸ç¬¬0æ­¥ä¸­æ‰€ç¤ºçš„æ”»å‡»æ–¹æ³•ç±»<code>I_FGSM</code>ç•¥æœ‰åŒºåˆ«</strong>ï¼Œæœ¬ä¾‹ä¸­æˆ‘ä»¬<strong>åœ¨æ”»å‡»æ–¹æ³•ç±»çš„<code>__init__</code>å‡½æ•°ä¸­å¢åŠ äº†æ”»å‡»æ–¹æ³•ç±»å‹<code>attack_type</code>å‚æ•°</strong>ï¼Œå¯¹äºæ”»å‡»æ–¹æ³•ç±»æ¥è¯´ï¼Œè¿™æ˜¯å¿…é¡»æ¥æ”¶çš„ä¸¤ä¸ªå‚æ•°ï¼Œå¦‚æœè¯¥æ”»å‡»æ–¹æ³•ä¸æ”¯æŒç›®æ ‡æ”»å‡»ï¼Œåˆ™å¯ä¸ä½¿ç”¨ä»¥ä¸Šå‚æ•°ã€‚</p> <p>åŒæ ·çš„ï¼Œæˆ‘ä»¬<strong>åœ¨æ”»å‡»æ–¹æ³•å‡½æ•°<code>attack()</code>å‡½æ•°ä¸­å¢åŠ äº†åŸå§‹æ ‡ç­¾<code>ori_labels</code>å’Œç›®æ ‡æ ‡ç­¾<code>tlabel</code>ä¸¤ä¸ªå‚æ•°</strong>ï¼Œå¯¹äºæ”»å‡»æ–¹æ³•å‡½æ•°æ¥è¯´ï¼Œè¿™æ˜¯å¿…é¡»æ¥æ”¶çš„ä¸¤ä¸ªå‚æ•°ï¼Œå¯ä¸ä½¿ç”¨ä»¥ä¸Šå‚æ•°ã€‚</p> <p>æ”»å‡»æ–¹æ³•ç±»<code>I_FGSM</code>çš„<code>__init__</code>å‡½æ•°æ¥æ”¶ä¸€ç»„å‚æ•°ï¼Œå…¶ä¸­<code>model</code>ã€<code>run_device</code>å’Œ<code>attack_type</code>å‚æ•°æ˜¯å¿…é€‰å‚æ•°ï¼Œå…¶ä½™å‚æ•°ç”±ç”¨æˆ·ä»»æ„æŒ‡å®šï¼Œå¹¶åœ¨åç»­é…ç½®ä¸­é…ç½®å³å¯ï¼š</p> <ul><li><code>model</code>æ˜¯æ¨¡å‹ç”Ÿæˆå‡½æ•°<code>create_model()</code>å‡½æ•°çš„è¾“å‡ºç»“æœï¼›</li> <li><code>run_device</code>æ˜¯è¿è¡Œè®¾å¤‡ï¼Œä¸€èˆ¬ä¸º<code>cpu</code>æˆ–<code>cuda</code>ï¼›</li> <li><code>attack_type</code>æ˜¯æ”»å‡»æ–¹æ³•ç±»å‹ï¼Œä»…æœ‰<code>TARGETED</code>ä¸<code>UNTARGETED</code>ä¸¤ç§å–å€¼ã€‚</li></ul> <p><code>attack()</code>å‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°<code>img</code>ã€<code>ori_labels</code>å’Œ<code>tlabel</code>å‚æ•°ï¼š</p> <ul><li><code>img</code>æ˜¯æ¨¡å‹é¢„å¤„ç†å‡½æ•°<code>img_pre_handler()</code>å‡½æ•°çš„è¾“å‡ºç»“æœï¼›</li> <li><code>ori_labels</code>æ˜¯æ•°æ®é›†æ ‡æ³¨çš„å›¾ç‰‡æ ‡ç­¾ï¼ˆ<code>Array</code>æ•°ç»„ï¼‰ï¼›</li> <li><code>tlabel</code>æ˜¯ç›®æ ‡æ”»å‡»æ ‡ç­¾ï¼ˆ<code>Array</code>æ•°ç»„ï¼‰ï¼Œè¯¥æ•°ç»„ä»…å½“éšæœºç›®æ ‡é€‰å‹é€‰ç”¨ï¼Œä¸”ç±»åˆå§‹åŒ–æ—¶<code>attack_type</code>è¢«è®¾ä¸º<code>TARGETED</code>æ—¶æ‰ä¼šä¼ å…¥ã€‚</li></ul> <p><code>attack()</code>å‡½æ•°äº§ç”Ÿå¯¹æŠ—æ ·æœ¬å›¾ç‰‡ï¼Œè¯¥å›¾ç‰‡å°†äº¤ç”±å›¾ç‰‡é€†å¤„ç†å‡½æ•°<code>img_post_handler()</code>å¤„ç†ã€‚</p> <h2 id="ç¬¬2æ­¥-é…ç½®canary"><a href="#ç¬¬2æ­¥-é…ç½®canary" class="header-anchor">#</a> ç¬¬2æ­¥ï¼šé…ç½®Canary</h2> <p>ç°åœ¨ï¼Œæ‚¨å·²ç»å°†ç”±æ‚¨è‡ªè¡Œæä¾›çš„æ¨¡å‹ã€æ”»å‡»æ–¹æ³•éƒ½é›†æˆè‡³<code>Canary</code>äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å¼€å§‹æ„å»ºä¸€ä¸ªæµ‹è¯•ä»»åŠ¡ã€‚</p> <p><strong>ğŸ‘‡è¯·å°†è¯¥éƒ¨åˆ†å­˜æ”¾åœ¨<code>run.py</code>ä¸­ğŸ‘‡</strong></p> <p>æˆ‘ä»¬é¦–å…ˆå¼•å…¥å¿…è¦ä¾èµ–ï¼Œå¹¶åŠ è½½æ¨¡å‹å’Œæ”»å‡»æ–¹æ³•è‡³<code>Canary</code>ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> random
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> canary_sefi<span class="token punctuation">.</span>core<span class="token punctuation">.</span>function<span class="token punctuation">.</span>enum<span class="token punctuation">.</span>multi_db_mode_enum <span class="token keyword">import</span> MultiDatabaseMode
<span class="token keyword">from</span> canary_sefi<span class="token punctuation">.</span>core<span class="token punctuation">.</span>function<span class="token punctuation">.</span>helper<span class="token punctuation">.</span>multi_db <span class="token keyword">import</span> use_multi_database
<span class="token keyword">from</span> canary_sefi<span class="token punctuation">.</span>core<span class="token punctuation">.</span>function<span class="token punctuation">.</span>helper<span class="token punctuation">.</span>recovery <span class="token keyword">import</span> global_recovery
<span class="token keyword">from</span> canary_sefi<span class="token punctuation">.</span>service<span class="token punctuation">.</span>security_evaluation <span class="token keyword">import</span> SecurityEvaluation
<span class="token keyword">from</span> canary_sefi<span class="token punctuation">.</span>task_manager <span class="token keyword">import</span> task_manager

<span class="token keyword">from</span> canary_sefi<span class="token punctuation">.</span>core<span class="token punctuation">.</span>component<span class="token punctuation">.</span>component_manager <span class="token keyword">import</span> SEFI_component_manager

<span class="token comment"># åŠ è½½æ”»å‡»æ–¹æ³•</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>attack <span class="token keyword">import</span> sefi_component <span class="token keyword">as</span> ifgsm_attacker
SEFI_component_manager<span class="token punctuation">.</span>add<span class="token punctuation">(</span>ifgsm_attacker<span class="token punctuation">)</span>

<span class="token comment"># åŠ è½½æ¨¡å‹</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>model <span class="token keyword">import</span> sefi_component <span class="token keyword">as</span> net
SEFI_component_manager<span class="token punctuation">.</span>add<span class="token punctuation">(</span>net<span class="token punctuation">)</span>
</code></pre></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ„å»ºé…ç½®ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code>example_config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment"># æ•°æ®é›†é…ç½®</span>
    <span class="token string">&quot;dataset_size&quot;</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># ç”¨äºæµ‹è¯•çš„å›¾ç‰‡æ•°é‡</span>
    <span class="token string">&quot;dataset&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;dataset_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;CIFAR10&quot;</span><span class="token punctuation">,</span> <span class="token comment"># æ•°æ®é›†åç§°ï¼Œæ­¤å¤„å¦‚æœæ˜¯Torchvisionå®šä¹‰çš„æ•°æ®é›†ä¼šè‡ªåŠ¨åŠ è½½</span>
        <span class="token string">&quot;dataset_path&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;workspace/dataset/CIFAR10&quot;</span><span class="token punctuation">,</span> <span class="token comment"># æ•°æ®é›†è·¯å¾„</span>
        <span class="token string">&quot;dataset_type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;TEST&quot;</span><span class="token punctuation">,</span> <span class="token comment"># æ•°æ®é›†ç±»å‹</span>
        <span class="token string">&quot;n_classes&quot;</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment"># æ•°æ®é›†ç±»æ•°é‡</span>
        <span class="token string">&quot;is_gray&quot;</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token comment"># æ•°æ®é›†æ˜¯å¦æ˜¯ç°åº¦å›¾</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment"># æ•°æ®é›†éšæœºé€‰å–å›¾ç‰‡çš„ç§å­</span>
    <span class="token string">&quot;dataset_seed&quot;</span><span class="token punctuation">:</span> random<span class="token punctuation">.</span>Random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    <span class="token comment"># æ¨¡å‹é…ç½®</span>
    <span class="token string">&quot;model_list&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;Net&quot;</span>  <span class="token comment"># æ¨¡å‹åï¼Œæœ¬ä¾‹ä¸­æ¨¡å‹åæ˜¯Net</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;inference_batch_config&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token comment"># æ¨¡å‹é¢„æµ‹çš„ Batch æ•°</span>
        <span class="token string">&quot;ResNet(CIFAR-10)&quot;</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment"># æ”»å‡»æ–¹æ³•é…ç½®</span>
    <span class="token string">&quot;attacker_list&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;I_FGSM&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  <span class="token comment"># æ”»å‡»æ–¹æ³•åï¼Œæœ¬ä¾‹ä¸­æ”»å‡»æ–¹æ³•åæ˜¯I_FGSM</span>
            <span class="token string">&quot;Net&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># æ”»å‡»æ–¹æ³•æ”»å‡»çš„ç›®æ ‡æ¨¡å‹</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;attacker_config&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token comment"># æ”»å‡»é…ç½®å‚æ•°</span>
        <span class="token string">&quot;I_FGSM&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token comment"># è¿™æ˜¯I_FGSMæ¨èçš„æ”»å‡»å‚æ•°</span>
            <span class="token string">&quot;clip_min&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;clip_max&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">&quot;T&quot;</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
            <span class="token string">&quot;attack_type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;UNTARGETED&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;epsilon&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;adv_example_generate_batch_config&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token comment"># æ¨¡å‹ç”Ÿæˆå¯¹æŠ—æ ·æœ¬çš„ Batch æ•°</span>
        <span class="token string">&quot;I_FGSM&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;ResNet(CIFAR-10)&quot;</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment"># è½¬ç§»æµ‹è¯•æ¨¡å¼ï¼šæœ¬ä¾‹ä¸­æˆ‘ä»¬åªé€‰æ‹©äº†ä¸€ä¸ªæ¨¡å‹ï¼Œä¸å­˜åœ¨è½¬ç§»æµ‹è¯•ï¼Œå› æ­¤ä¸ºNOT</span>
    <span class="token string">&quot;transfer_attack_test_mode&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;NOT&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ç¬¬3æ­¥-canaryå¯åŠ¨"><a href="#ç¬¬3æ­¥-canaryå¯åŠ¨" class="header-anchor">#</a> ç¬¬3æ­¥ï¼šCanaryå¯åŠ¨</h2> <p>æˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸€ä¸‹<code>Canary</code>çš„ç³»ç»Ÿé…ç½®ï¼Œå¹¶å°†ä»¥ä¸‹å†…å®¹å­˜å…¥ <code>config.json</code>ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨<code>datasetPath</code>å’Œ<code>baseTempPath</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æ•°æ®é›†è·¯å¾„å’Œä¸´æ—¶æ–‡ä»¶è·¯å¾„ã€‚</p> <p>å¦‚æœæ‚¨ä¸æ‰“ç®—ä½¿ç”¨<code>Canary WebView</code>ï¼Œ<code>appName</code>ã€<code>appDesc</code>å¯¹æ‚¨æ¯«æ— æ„ä¹‰ï¼Œå®Œå…¨å¯ä»¥ä¸å¿…å¡«å†™ã€‚</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;appName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CANARY Test&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;appDesc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;This is an example program to start test using Canary SEFI&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;datasetPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/workplace/dataset/&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;baseTempPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/workplace/temp/&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;centerDatabasePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/workplace/temp/&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;system&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;limited_read_img_size&quot;</span><span class="token operator">:</span> <span class="token number">900</span><span class="token punctuation">,</span>
    <span class="token property">&quot;use_file_memory_cache&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;save_fig_model&quot;</span><span class="token operator">:</span> <span class="token string">&quot;save_img_file&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨è¯¥é…ç½®å¯åŠ¨ <s>åŸç¥</s> <code>Canary</code>è¿è¡Œè¯„ä¼°æµ‹è¯•ï¼š</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># åˆå§‹åŒ–ä»»åŠ¡ï¼Œä½¿ç”¨æ˜¾å¡CUDAè®¾å¤‡è¿è¡Œä»»åŠ¡</span>
    task_manager<span class="token punctuation">.</span>init_task<span class="token punctuation">(</span>show_logo<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> run_device<span class="token operator">=</span><span class="token string">&quot;cuda&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># è®¾ç½®å½“å‰æ¨¡å¼ä¸ºç®€å•æ•°æ®åº“æ¨¡å¼ï¼ˆéé«˜çº§ç”¨æˆ·è¯·å‹¿ä¿®æ”¹æ­¤è®¾ç½®ï¼‰</span>
    use_multi_database<span class="token punctuation">(</span>mode<span class="token operator">=</span>MultiDatabaseMode<span class="token punctuation">.</span>SIMPLE<span class="token punctuation">)</span>

    <span class="token comment"># ä½¿ç”¨é…ç½®æ„å»ºè¯„ä¼°ä»»åŠ¡å¹¶å¯åŠ¨</span>
    security_evaluation <span class="token operator">=</span> SecurityEvaluation<span class="token punctuation">(</span>example_config<span class="token punctuation">)</span>
    security_evaluation<span class="token punctuation">.</span>attack_full_test<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="æœ€åæç¤º"><a href="#æœ€åæç¤º" class="header-anchor">#</a> æœ€åæç¤º</h2> <p>æ­å–œï¼Œæ‚¨åˆšåˆšä½¿ç”¨<code>I-FGSM</code>å¯¹<code>CNN</code>æ¨¡å‹è¿›è¡Œäº†ä¸€æ¬¡å¯¹æŠ—æ”»å‡»ï¼Œå¹¶è¯„ä¼°äº†è¯¥æ¨¡å‹çš„é²æ£’æ€§ä¸æ”»å‡»æ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚æ‚¨æ‰€çœ‹åˆ°çš„ç›¸åŒæ–¹æ³•å¯ä»¥ç”¨äºå…¶ä»–æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆä¸ä»…ä»…æ˜¯åŸºäº<code>CIFAR-10</code>è®­ç»ƒçš„ç®€å•<code>CNN</code>ï¼‰å’Œæ”»å‡»æ–¹æ³•ï¼ˆä¸ä»…ä»…æ˜¯<code>I-FGSM</code>ï¼‰</p> <p>åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›æ›´æ˜“äºä½¿ç”¨çš„æ–¹æ³•ã€‚ä¸æƒ³è‡ªå·±å®ç°ä¸»æµçš„æ”»å‡»å’Œé˜²å¾¡æ–¹æ³•ï¼Ÿä¸æƒ³è‡ªå·±è®­ç»ƒç”¨äºæµ‹è¯•çš„æ ‡å‡†æ¨¡å‹ï¼Ÿæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ä¸ªæ•™ç¨‹ä¸­ä»‹ç»æ‰€æœ‰è¿™äº›ä»¥åŠæ›´å¤šå†…å®¹ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/Canary/start/what_is_adversarial_attack_and_model_robustness.html" class="prev">
        ä»€ä¹ˆæ˜¯å¯¹æŠ—æ”»å‡»ä¸æ¨¡å‹é²æ£’æ€§ï¼Ÿ
      </a></span> <span class="next"><a href="/Canary/start/get-started-with-canary-sefi-use-library.html">
        å¼€å§‹ä½¿ç”¨ Canary Library
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Canary/assets/js/app.998a5de4.js" defer></script><script src="/Canary/assets/js/2.eeb24f79.js" defer></script><script src="/Canary/assets/js/22.13e22dab.js" defer></script>
  </body>
</html>
